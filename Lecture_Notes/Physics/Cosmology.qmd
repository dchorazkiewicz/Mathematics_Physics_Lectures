---
title: Cosmology and Astrophysics
format:
  html:
    theme: flatly
    grid:
      body-width: 1000px      # Domy≈õlnie jest to ok. 800-900px
      margin-width: 250px  
    toc: true
    toc-depth: 3
    highlight-style: tango
    code-line-numbers: true
    code-fold: true
    code-summary: "Show the code"
    code-tools: true
    code-block-bg: "rgba(42, 174, 42, 0.02)"
    code-block-border-left: "#2aae2a"
    code-language-label: true
    css: styles.css
    math: mathjax
    self-contained: true
    other-links:
      - text: Main page
        href: https://dchorazkiewicz.github.io/Mathematics_Physics_Lectures
---


<iframe src="html_anim/cosmology/ptolomeo.html" width="100%" height="700px"></iframe>
[html_anim/cosmology/ptolomeo.html](html_anim/cosmology/ptolomeo.html)

<iframe src="html_anim/cosmology/copernicus.html" width="100%" height="700px"></iframe>
[html_anim/cosmology/copernicus.html](html_anim/cosmology/copernicus.html)

<iframe src="html_anim/cosmology/kepler.html" width="100%" height="700px"></iframe>
[html_anim/cosmology/kepler.html](html_anim/cosmology/kepler.html)


## Mathematical Model of the Ptolemaic System

This description defines the geocentric system using vector algebra and analytic geometry. It is designed to be directly translatable into code (e.g., JavaScript/GLSL) for a 3D simulation.

The model calculates the position of a planet $P$ relative to the Earth $E$ at the origin $(0,0,0)$.

### 1. System Parameters

For each planet, the following scalar constants must be defined:

* $R$: Radius of the deferent (the major orbital circle).
* $r$: Radius of the epicycle (the minor orbital circle).
* $e$: Eccentricity (distance from Earth to the Deferent Center).
* $\lambda_0$: Mean longitude at epoch (starting angle on the deferent).
* $\beta_0$: Mean anomaly at epoch (starting angle on the epicycle).
* $\Omega$: Longitude of the ascending node.
* $i$: Inclination of the deferent plane relative to the ecliptic.
* $n_d$: Mean angular velocity of the epicycle center (deferent motion).
* $n_e$: Mean angular velocity of the planet (epicycle motion).

### 2. Coordinate System and Key Points

We assume a right-handed Cartesian coordinate system where the Earth is stationary at the origin.

* **Earth ($E$):** $(0, 0, 0)$
* **Deferent Center ($C$):** $(e, 0, 0)$
* **Equant Point ($Q$):** $(2e, 0, 0)$

Note: The centers are aligned along the $X$ axis (the line of apsides) for the initial calculation. We will rotate the entire system later to match the longitude of the apogee.

### 3. Calculating the Epicycle Center ($K$)

The center of the epicycle, point $K$, moves along the deferent (a circle of radius $R$ centered at $C$). However, its angular motion is uniform relative to the **Equant** ($Q$), not the geometric center ($C$).

At time $t$, the mean anomaly angle $M$ is:

$$
M(t) = \lambda_0 + n_d \cdot t
$$

To find the coordinates of $K$, we must find the intersection of a ray originating from $Q$ at angle $M(t)$ with the circle centered at $C$.

Vector equation for the ray from the Equant:

$$
\vec{Q} = [2e, 0, 0]
$$

$$
\vec{v}_{dir} = [\cos(M), \sin(M), 0]
$$

We need to find the distance $\rho$ from the Equant to the Deferent such that the point $K = Q + \rho \cdot \vec{v}_{dir}$ lies on the circle defined by $|K - C|^2 = R^2$.

Substituting the coordinates results in a quadratic equation for $\rho$:

$$
\rho^2 + (2e \cos M) \rho + (3e^2 - R^2) = 0
$$

Solving for $\rho$ (taking the positive root):

$$
\rho = \frac{-(2e \cos M) + \sqrt{(2e \cos M)^2 - 4(1)(3e^2 - R^2)}}{2}
$$

Once $\rho$ is known, the position of the epicycle center $K$ in the orbital plane is:

$$
x_k = 2e + \rho \cos M
$$

$$
y_k = \rho \sin M
$$

$$
z_k = 0
$$

### 4. Calculating the Planet Position on the Epicycle ($P$)

The planet moves uniformly on the epicycle relative to the line connecting the Equant to the epicycle center (in some versions) or relative to the deferent center. For a standard analytic implementation, we define the local epicyclic angle $\gamma$.

$$
\gamma(t) = \beta_0 + n_e \cdot t
$$

The local position of the planet relative to the center $K$ is:

$$
\vec{p}_{local} = [r \cos \gamma, r \sin \gamma, 0]
$$

The combined position in the 2D orbital plane (before inclination) is:

$$
P_{orb} = [x_k, y_k, 0] + \vec{p}_{local}
$$

So:

$$
x_{orb} = 2e + \rho \cos M + r \cos \gamma
$$

$$
y_{orb} = \rho \sin M + r \sin \gamma
$$

### 5. 3D Transformations (Inclination and Node)

To place the planet in 3D space relative to the ecliptic, we apply rotation matrices.

1.  **Inclination ($i$):** Rotate around the $X$ axis (assuming the line of nodes is initially the X-axis).
2.  **Longitude of Ascending Node ($\Omega$):** Rotate around the $Z$ axis to orient the orbit in the sky.

**Step A: Apply Inclination**

$$
x' = x_{orb}
$$

$$
y' = y_{orb} \cos i
$$

$$
z' = y_{orb} \sin i
$$

**Step B: Apply Longitude of Ascending Node**

$$
X = x' \cos \Omega - y' \sin \Omega
$$

$$
Y = x' \sin \Omega + y' \cos \Omega
$$

$$
Z = z'
$$

The vector $\vec{P}_{final} = [X, Y, Z]$ represents the final coordinates of the planet in the 3D simulation space.